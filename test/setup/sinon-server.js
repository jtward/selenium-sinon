!function(a,b){"function"==typeof define&&define.amd?define("sinon",[],function(){return a.sinon=b()}):"object"==typeof exports?module.exports=b():a.sinon=b()}(this,function(){var samsam,formatio;!function(){function define(a,b,c){"samsam"==a?samsam=b():"function"==typeof b&&0===a.length?lolex=b():"function"==typeof c&&(formatio=c(samsam))}define.amd={},("function"==typeof define&&define.amd&&function(a){define("samsam",a)}||"object"==typeof module&&function(a){module.exports=a()}||function(a){this.samsam=a()})(function(){function c(a){var b=a;return"number"==typeof a&&a!==b}function d(b){return a.toString.call(b).split(/[ \]]/)[1]}function e(a){if("Arguments"===d(a))return!0;if("object"!=typeof a||"number"!=typeof a.length||"Array"===d(a))return!1;if("function"==typeof a.callee)return!0;try{a[a.length]=6,delete a[a.length]}catch(b){return!0}return!1}function f(a){if(!a||1!==a.nodeType||!b)return!1;try{a.appendChild(b),a.removeChild(b)}catch(c){return!1}return!0}function g(b){var d,c=[];for(d in b)a.hasOwnProperty.call(b,d)&&c.push(d);return c}function h(a){return"function"==typeof a.getTime&&a.getTime()==a.valueOf()}function i(a){return 0===a&&1/a===-1/0}function j(a,b){return a===b||c(a)&&c(b)?0!==a||i(a)===i(b):void 0}function k(b,i){function p(a){return"object"!=typeof a||null===a||a instanceof Boolean||a instanceof Date||a instanceof Number||a instanceof RegExp||a instanceof String?!1:!0}function q(a,b){var c;for(c=0;c<a.length;c++)if(a[c]===b)return c;return-1}var k=[],l=[],m=[],n=[],o={};return function r(b,i,s,t){var u=typeof b,v=typeof i;if(b===i||c(b)||c(i)||null==b||null==i||"object"!==u||"object"!==v)return j(b,i);if(f(b)||f(i))return!1;var w=h(b),x=h(i);if(!(!w&&!x||w&&x&&b.getTime()===i.getTime()))return!1;if(b instanceof RegExp&&i instanceof RegExp&&b.toString()!==i.toString())return!1;var y=d(b),z=d(i),A=g(b),B=g(i);if(e(b)||e(i)){if(b.length!==i.length)return!1}else if(u!==v||y!==z||A.length!==B.length)return!1;var C,D,E,F,G,H,I,J,K,L,M;for(D=0,E=A.length;E>D;D++){if(C=A[D],!a.hasOwnProperty.call(i,C))return!1;if(F=b[C],G=i[C],H=p(F),I=p(G),J=H?q(k,F):-1,K=I?q(l,G):-1,L=-1!==J?m[J]:s+"["+JSON.stringify(C)+"]",M=-1!==K?n[K]:t+"["+JSON.stringify(C)+"]",o[L+M])return!0;if(-1===J&&H&&(k.push(F),m.push(L)),-1===K&&I&&(l.push(G),n.push(M)),H&&I&&(o[L+M]=!0),!r(F,G,L,M))return!1}return!0}(b,i,"$1","$2")}function m(a,b){if(0===b.length)return!0;var c,d,e,f;for(c=0,d=a.length;d>c;++c)if(l(a[c],b[0])){for(e=0,f=b.length;f>e;++e)if(!l(a[c+e],b[e]))return!1;return!0}return!1}var l,a=Object.prototype,b="undefined"!=typeof document&&document.createElement("div");return l=function n(a,b){if(b&&"function"==typeof b.test)return b.test(a);if("function"==typeof b)return b(a)===!0;if("string"==typeof b){b=b.toLowerCase();var c="string"==typeof a||!!a;return c&&String(a).toLowerCase().indexOf(b)>=0}if("number"==typeof b)return b===a;if("boolean"==typeof b)return b===a;if("undefined"==typeof b)return"undefined"==typeof a;if(null===b)return null===a;if("Array"===d(a)&&"Array"===d(b))return m(a,b);if(b&&"object"==typeof b){if(b===a)return!0;var e;for(e in b){var f=a[e];if("undefined"==typeof f&&"function"==typeof a.getAttribute&&(f=a.getAttribute(e)),null===b[e]||"undefined"==typeof b[e]){if(f!==b[e])return!1}else if("undefined"==typeof f||!n(f,b[e]))return!1}return!0}throw new Error("Matcher was not a string, a number, a function, a boolean or an object")},{isArguments:e,isElement:f,isDate:h,isNegZero:i,identical:j,deepEqual:k,match:l,keys:g}}),("function"==typeof define&&define.amd&&function(a){define("formatio",["samsam"],a)}||"object"==typeof module&&function(a){module.exports=a(require("samsam"))}||function(a){this.formatio=a(this.samsam)})(function(a){function e(a){if(!a)return"";if(a.displayName)return a.displayName;if(a.name)return a.name;var b=a.toString().match(/function\s+([^\(]+)/m);return b&&b[1]||""}function f(a,c){var g,h,d=e(c&&c.constructor),f=a.excludeConstructors||b.excludeConstructors||[];for(g=0,h=f.length;h>g;++g){if("string"==typeof f[g]&&f[g]===d)return"";if(f[g].test&&f[g].test(d))return""}return d}function g(a,b){if("object"!=typeof a)return!1;var c,d;for(c=0,d=b.length;d>c;++c)if(b[c]===a)return!0;return!1}function h(b,c,e,f){if("string"==typeof c){var i=b.quoteStrings,j="boolean"!=typeof i||i;return e||j?'"'+c+'"':c}if("function"==typeof c&&!(c instanceof RegExp))return h.func(c);if(e=e||[],g(c,e))return"[Circular]";if("[object Array]"===Object.prototype.toString.call(c))return h.array.call(b,c,e);if(!c)return String(1/c===-1/0?"-0":c);if(a.isElement(c))return h.element(c);if("function"==typeof c.toString&&c.toString!==Object.prototype.toString)return c.toString();var k,l;for(k=0,l=d.length;l>k;k++)if(c===d[k].object)return d[k].value;return h.object.call(b,c,e,f)}function i(a){for(var b in a)this[b]=a[b]}var b={excludeConstructors:["Object",/^.$/],quoteStrings:!0,limitChildrenCount:0};Object.prototype.hasOwnProperty;var d=[];return"undefined"!=typeof global&&d.push({object:global,value:"[object global]"}),"undefined"!=typeof document&&d.push({object:document,value:"[object HTMLDocument]"}),"undefined"!=typeof window&&d.push({object:window,value:"[object Window]"}),h.func=function(a){return"function "+e(a)+"() {}"},h.array=function(a,b){b=b||[],b.push(a);var d,e,c=[];for(e=this.limitChildrenCount>0?Math.min(this.limitChildrenCount,a.length):a.length,d=0;e>d;++d)c.push(h(this,a[d],b));return e<a.length&&c.push("[... "+(a.length-e)+" more elements]"),"["+c.join(", ")+"]"},h.object=function(b,c,d){c=c||[],c.push(b),d=d||0;var k,l,m,n,o,p,e=[],i=a.keys(b).sort(),j=3;for(p=this.limitChildrenCount>0?Math.min(this.limitChildrenCount,i.length):i.length,n=0;p>n;++n)k=i[n],m=b[k],l=g(m,c)?"[Circular]":h(this,m,c,d+2),l=(/\s/.test(k)?'"'+k+'"':k)+": "+l,j+=l.length,e.push(l);var q=f(this,b),r=q?"["+q+"] ":"",s="";for(n=0,o=d;o>n;++n)s+=" ";return p<i.length&&e.push("[... "+(i.length-p)+" more elements]"),j+d>80?r+"{\n  "+s+e.join(",\n  "+s)+"\n"+s+"}":r+"{ "+e.join(", ")+" }"},h.element=function(a){var d,f,g,h,i,b=a.tagName.toLowerCase(),c=a.attributes,e=[];for(g=0,h=c.length;h>g;++g)d=c.item(g),f=d.nodeName.toLowerCase().replace("html:",""),i=d.nodeValue,("contenteditable"!==f||"inherit"!==i)&&i&&e.push(f+'="'+i+'"');var j="<"+b+(e.length>0?" ":""),k=a.innerHTML;k.length>20&&(k=k.substr(0,20)+"[...]");var l=j+e.join(" ")+">"+k+"</"+b+">";return l.replace(/ contentEditable="inherit"/,"")},i.prototype={functionName:e,configure:function(a){return new i(a)},constructorName:function(a){return f(this,a)},ascii:function(a,b,c){return h(this,a,b,c)}},i.prototype}),!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.lolex=a()}}(function(){var define,module,exports;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(require,module,exports){!function(global){function parseTime(a){if(!a)return 0;var f,b=a.split(":"),c=b.length,d=c,e=0;if(c>3||!/^(\d\d:){0,2}\d\d?$/.test(a))throw new Error("tick only understands numbers and 'h:m:s'");for(;d--;){if(f=parseInt(b[d],10),f>=60)throw new Error("Invalid time "+a);e+=f*Math.pow(60,c-d-1)}return 1e3*e}function getEpoch(a){if(!a)return 0;if("function"==typeof a.getTime)return a.getTime();if("number"==typeof a)return a;throw new TypeError("now should be milliseconds since UNIX epoch")}function inRange(a,b,c){return c&&c.callAt>=a&&c.callAt<=b}function mirrorDateProperties(a,b){b.now?a.now=function(){return a.clock.now}:delete a.now,b.toSource?a.toSource=function(){return b.toSource()}:delete a.toSource,a.toString=function(){return b.toString()},a.prototype=b.prototype,a.parse=b.parse,a.UTC=b.UTC,a.prototype.toUTCString=b.prototype.toUTCString;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function createDate(){function a(b,c,d,e,f,g,h){switch(arguments.length){case 0:return new NativeDate(a.clock.now);case 1:return new NativeDate(b);case 2:return new NativeDate(b,c);case 3:return new NativeDate(b,c,d);case 4:return new NativeDate(b,c,d,e);case 5:return new NativeDate(b,c,d,e,f);case 6:return new NativeDate(b,c,d,e,f,g);default:return new NativeDate(b,c,d,e,f,g,h)}}return mirrorDateProperties(a,NativeDate)}function addTimer(a,b){if("undefined"==typeof b.func)throw new Error("Callback must be provided to timer calls");return a.timers||(a.timers={}),b.id=id++,b.createdAt=a.now,b.callAt=a.now+(b.delay||0),a.timers[b.id]=b,addTimerReturnsObject?{id:b.id,ref:function(){},unref:function(){}}:b.id}function firstTimerInRange(a,b,c){var d=a.timers,e=null;for(var f in d)inRange(b,c,d[f])&&(!e||~compareTimers(e,d[f]))&&(e=d[f]);return e}function compareTimers(a,b){return a.callAt<b.callAt?-1:a.callAt>b.callAt?1:a.immediate&&!b.immediate?-1:!a.immediate&&b.immediate?1:a.createdAt<b.createdAt?-1:a.createdAt>b.createdAt?1:a.id<b.id?-1:a.id>b.id?1:void 0}function callTimer(clock,timer){"number"==typeof timer.interval?clock.timers[timer.id].callAt+=timer.interval:delete clock.timers[timer.id];try{"function"==typeof timer.func?timer.func.apply(null,timer.args):eval(timer.func)}catch(e){var exception=e}if(clock.timers[timer.id]){if(exception)throw exception}else if(exception)throw exception}function uninstall(a,b){for(var c,d=0,e=a.methods.length;e>d;d++)if(c=a.methods[d],b[c].hadOwnProperty)b[c]=a["_"+c];else try{delete b[c]}catch(f){}a.methods=[]}function hijackMethod(a,b,c){if(c[b].hadOwnProperty=Object.prototype.hasOwnProperty.call(a,b),c["_"+b]=a[b],"Date"==b){var d=mirrorDateProperties(c[b],a[b]);a[b]=d}else{a[b]=function(){return c[b].apply(c,arguments)};for(var e in c[b])c[b].hasOwnProperty(e)&&(a[b][e]=c[b][e])}a[b].clock=c}var timeoutResult=setTimeout(function(){},0),addTimerReturnsObject="object"==typeof timeoutResult;clearTimeout(timeoutResult);var NativeDate=Date,id=1,timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:"undefined"!=typeof setImmediate?setImmediate:void 0,clearImmediate:"undefined"!=typeof clearImmediate?clearImmediate:void 0,setInterval:setInterval,clearInterval:clearInterval,Date:Date},keys=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};exports.timers=timers;var createClock=exports.createClock=function(a){var b={now:getEpoch(a),timeouts:{},Date:createDate()};return b.Date.clock=b,b.setTimeout=function(a,c){return addTimer(b,{func:a,args:Array.prototype.slice.call(arguments,2),delay:c})},b.clearTimeout=function(a){a&&(b.timers||(b.timers=[]),"object"==typeof a&&(a=a.id),a in b.timers&&delete b.timers[a])},b.setInterval=function(a,c){return addTimer(b,{func:a,args:Array.prototype.slice.call(arguments,2),delay:c,interval:c})},b.clearInterval=function(a){b.clearTimeout(a)},b.setImmediate=function(a){return addTimer(b,{func:a,args:Array.prototype.slice.call(arguments,1),immediate:!0})},b.clearImmediate=function(a){b.clearTimeout(a)},b.tick=function(a){a="number"==typeof a?a:parseTime(a);for(var g,c=b.now,d=b.now+a,e=b.now,f=firstTimerInRange(b,c,d);f&&d>=c;){if(b.timers[f.id]){c=b.now=f.callAt;try{callTimer(b,f)}catch(h){g=g||h}}f=firstTimerInRange(b,e,d),e=c}if(b.now=d,g)throw g;return b.now},b.reset=function(){b.timers={}},b};exports.install=function(a,b,c){"number"==typeof a&&(c=b,b=a,a=null),a||(a=global);var d=createClock(b);d.uninstall=function(){uninstall(d,a)},d.methods=c||[],0===d.methods.length&&(d.methods=keys(timers));for(var e=0,f=d.methods.length;f>e;e++)hijackMethod(a,d.methods[e],d);return d}}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)})}();var define,sinon=function(){"use strict";function d(b,c,d){a=d.exports=b("./sinon/util/core"),b("./sinon/extend"),b("./sinon/typeOf"),b("./sinon/times_in_words"),b("./sinon/spy"),b("./sinon/call"),b("./sinon/behavior"),b("./sinon/stub"),b("./sinon/mock"),b("./sinon/collection"),b("./sinon/assert"),b("./sinon/sandbox"),b("./sinon/test"),b("./sinon/test_case"),b("./sinon/match"),b("./sinon/format"),b("./sinon/log_error")}var a,b="undefined"!=typeof module&&module.exports&&"function"==typeof require,c="function"==typeof define&&"object"==typeof define.amd&&define.amd;return c?define(d):b?(d(require,module.exports,module),a=module.exports):a={},a}();if(function(a){function d(a){var c=!1;try{a.appendChild(b),c=b.parentNode==a}catch(d){return!1}finally{try{a.removeChild(b)}catch(d){}}return c}function e(a){return b&&a&&1===a.nodeType&&d(a)}function f(a){return"function"==typeof a||!!(a&&a.constructor&&a.call&&a.apply)}function g(a){return"number"==typeof a&&isNaN(a)}function h(a,b){for(var d in b)c.call(a,d)||(a[d]=b[d])}function i(a){return"function"==typeof a&&"function"==typeof a.restore&&a.restore.sinon}function k(a){return a.wrapMethod=function(b,d,e){function g(a){if(f(a)){if(a.restore&&a.restore.sinon)i=new TypeError("Attempted to wrap "+d+" which is already wrapped");else if(a.calledBefore){var b=a.returns?"stubbed":"spied on";i=new TypeError("Attempted to wrap "+d+" which is already "+b)}}else i=new TypeError("Attempted to wrap "+typeof a+" property "+d+" as function");if(i)throw a&&a.stackTrace&&(i.stack+="\n--------------\n"+a.stackTrace),i}if(!b)throw new TypeError("Should wrap property of object");if("function"!=typeof e&&"object"!=typeof e)throw new TypeError("Method wrapper should be a function or a property descriptor");var i,k,l=b.hasOwnProperty?b.hasOwnProperty(d):c.call(b,d);if(j){var o,m="function"==typeof e?{value:e}:e,n=a.getPropertyDescriptor(b,d);if(n?n.restore&&n.restore.sinon&&(i=new TypeError("Attempted to wrap "+d+" which is already wrapped")):i=new TypeError("Attempted to wrap "+typeof k+" property "+d+" as function"),i)throw n&&n.stackTrace&&(i.stack+="\n--------------\n"+n.stackTrace),i;var p=a.objectKeys(m);for(o=0;o<p.length;o++)k=n[p[o]],g(k);for(h(m,n),o=0;o<p.length;o++)h(m[p[o]],n[p[o]]);Object.defineProperty(b,d,m)}else k=b[d],g(k),b[d]=e,e.displayName=d;return e.displayName=d,e.stackTrace=new Error("Stack Trace for original").stack,e.restore=function(){if(l)j&&Object.defineProperty(b,d,n);else{try{delete b[d]}catch(a){}b[d]===e&&(b[d]=k)}j||b[d]!==e||(b[d]=k)},e.restore.sinon=!0,j||h(e,k),e},a.create=function(a){var b=function(){};return b.prototype=a,new b},a.deepEqual=function k(b,c){if(a.match&&a.match.isMatcher(b))return b.test(c);if("object"!=typeof b||"object"!=typeof c)return g(b)&&g(c)?!0:b===c;if(e(b)||e(c))return b===c;if(b===c)return!0;if(null===b&&null!==c||null!==b&&null===c)return!1;if(b instanceof RegExp&&c instanceof RegExp)return b.source===c.source&&b.global===c.global&&b.ignoreCase===c.ignoreCase&&b.multiline===c.multiline;var d=Object.prototype.toString.call(b);if(d!=Object.prototype.toString.call(c))return!1;if("[object Date]"==d)return b.valueOf()===c.valueOf();var f,h=0,i=0;if("[object Array]"==d&&b.length!==c.length)return!1;for(f in b){if(h+=1,!(f in c))return!1;if(!k(b[f],c[f]))return!1}for(f in c)i+=1;return h==i},a.functionName=function(a){var b=a.displayName||a.name;if(!b){var c=a.toString().match(/function ([^\s\(]+)/);b=c&&c[1]}return b},a.functionToString=function(){if(this.getCall&&this.callCount)for(var a,b,c=this.callCount;c--;){a=this.getCall(c).thisValue;for(b in a)if(a[b]===this)return b}return this.displayName||"sinon fake"},a.objectKeys=function(a){if(a!==Object(a))throw new TypeError("sinon.objectKeys called on a non-object");var d,b=[];for(d in a)c.call(a,d)&&b.push(d);return b},a.getPropertyDescriptor=function(a,b){for(var d,c=a;c&&!(d=Object.getOwnPropertyDescriptor(c,b));)c=Object.getPrototypeOf(c);return d},a.getConfig=function(b){var c={};b=b||{};var d=a.defaultConfig;for(var e in d)d.hasOwnProperty(e)&&(c[e]=b.hasOwnProperty(e)?b[e]:d[e]);return c},a.defaultConfig={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},a.timesInWords=function(a){return 1==a&&"once"||2==a&&"twice"||3==a&&"thrice"||(a||0)+" times"},a.calledInOrder=function(a){for(var b=1,c=a.length;c>b;b++)if(!a[b-1].calledBefore(a[b])||!a[b].called)return!1;return!0},a.orderByFirstCall=function(a){return a.sort(function(a,b){var c=a.getCall(0),d=b.getCall(0),e=c&&c.callId||-1,f=d&&d.callId||-1;return f>e?-1:1})},a.createStubInstance=function(b){if("function"!=typeof b)throw new TypeError("The constructor should be a function.");return a.stub(a.create(b.prototype))},a.restore=function(a){if(null!==a&&"object"==typeof a)for(var b in a)i(a[b])&&a[b].restore();else i(a)&&a.restore()},a}function n(a,b){k(b)}var b="undefined"!=typeof document&&document.createElement("div"),c=Object.prototype.hasOwnProperty,j="keys"in Object,l="undefined"!=typeof module&&module.exports&&"function"==typeof require,m="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(m)define(n);else if(l)n(require,module.exports);else{if(!a)return;k(a)}}("object"==typeof sinon&&sinon||null),function(a){function b(a){function c(a){var d,e,f,c=Array.prototype.slice.call(arguments,1);for(e=0;e<c.length;e++){d=c[e];for(f in d)d.hasOwnProperty(f)&&(a[f]=d[f]);b&&d.hasOwnProperty("toString")&&d.toString!==a.toString&&(a.toString=d.toString)}return a}var b=function(){var a={constructor:function(){return"0"},toString:function(){return"1"},valueOf:function(){return"2"},toLocaleString:function(){return"3"},prototype:function(){return"4"},isPrototypeOf:function(){return"5"},propertyIsEnumerable:function(){return"6"},hasOwnProperty:function(){return"7"},length:function(){return"8"},unique:function(){return"9"}},b=[];for(var c in a)b.push(a[c]());return"0123456789"!==b.join("")}();return a.extend=c,a.extend}function c(a,c,d){var e=a("./util/core");d.exports=b(e)}var d="undefined"!=typeof module&&module.exports&&"function"==typeof require,e="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(e)define(c);else if(d)c(require,module.exports,module);else{if(!a)return;b(a)}}("object"==typeof sinon&&sinon||null),function(a){function b(a){function b(a){switch(a){case 1:return"once";case 2:return"twice";case 3:return"thrice";default:return(a||0)+" times"}}return a.timesInWords=b,a.timesInWords}function c(a,c,d){var e=a("./util/core");d.exports=b(e)}var d="undefined"!=typeof module&&module.exports&&"function"==typeof require,e="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(e)define(c);else if(d)c(require,module.exports,module);else{if(!a)return;b(a)}}("object"==typeof sinon&&sinon||null),function(a){function c(a){function b(a){if(null===a)return"null";if(void 0===a)return"undefined";var b=Object.prototype.toString.call(a);return b.substring(8,b.length-1).toLowerCase()}return a.typeOf=b,a.typeOf}function d(a,b,d){var e=a("./util/core");d.exports=c(e)}var e="undefined"!=typeof module&&module.exports&&"function"==typeof require,f="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(f)define(d);else if(e)d(require,module.exports,module);else{if(!a)return;c(a)}}("object"==typeof sinon&&sinon||null,"object"==typeof formatio&&formatio),function(a){function b(a){function b(b,c,d){var e=a.typeOf(b);if(e!==c)throw new TypeError("Expected type of "+d+" to be "+c+", but was "+e)}function d(a){return c.isPrototypeOf(a)}function e(b,c){if(null===c||void 0===c)return!1;for(var d in b)if(b.hasOwnProperty(d)){var g=b[d],h=c[d];if(f.isMatcher(g)){if(!g.test(h))return!1}else if("object"===a.typeOf(g)){if(!e(g,h))return!1}else if(!a.deepEqual(g,h))return!1}return!0}function g(c,d){return function(e,g){b(e,"string","property");var h=1===arguments.length,i=d+'("'+e+'"';return h||(i+=", "+g),i+=")",f(function(b){return void 0!==b&&null!==b&&c(b,e)?h||a.deepEqual(g,b[e]):!1},i)}}var c={toString:function(){return this.message}};c.or=function(b){if(!arguments.length)throw new TypeError("Matcher expected");d(b)||(b=f(b));var e=this,g=a.create(c);return g.test=function(a){return e.test(a)||b.test(a)},g.message=e.message+".or("+b.message+")",g},c.and=function(b){if(!arguments.length)throw new TypeError("Matcher expected");d(b)||(b=f(b));var e=this,g=a.create(c);return g.test=function(a){return e.test(a)&&b.test(a)},g.message=e.message+".and("+b.message+")",g};var f=function(b,d){var f=a.create(c),g=a.typeOf(b);switch(g){case"object":if("function"==typeof b.test)return f.test=function(a){return b.test(a)===!0},f.message="match("+a.functionName(b.test)+")",f;var h=[];for(var i in b)b.hasOwnProperty(i)&&h.push(i+": "+b[i]);f.test=function(a){return e(b,a)},f.message="match("+h.join(", ")+")";break;case"number":f.test=function(a){return b==a};break;case"string":f.test=function(a){return"string"!=typeof a?!1:-1!==a.indexOf(b)},f.message='match("'+b+'")';break;case"regexp":f.test=function(a){return"string"!=typeof a?!1:b.test(a)};break;case"function":f.test=b,f.message=d?d:"match("+a.functionName(b)+")";break;default:f.test=function(c){return a.deepEqual(b,c)}}return f.message||(f.message="match("+b+")"),f};return f.isMatcher=d,f.any=f(function(){return!0},"any"),f.defined=f(function(a){return null!==a&&void 0!==a},"defined"),f.truthy=f(function(a){return!!a},"truthy"),f.falsy=f(function(a){return!a},"falsy"),f.same=function(a){return f(function(b){return a===b},"same("+a+")")},f.typeOf=function(c){return b(c,"string","type"),f(function(b){return a.typeOf(b)===c},'typeOf("'+c+'")')},f.instanceOf=function(c){return b(c,"function","type"),f(function(a){return a instanceof c},"instanceOf("+a.functionName(c)+")")},f.has=g(function(a,b){return"object"==typeof a?b in a:void 0!==a[b]},"has"),f.hasOwn=g(function(a,b){return a.hasOwnProperty(b)},"hasOwn"),f.bool=f.typeOf("boolean"),f.number=f.typeOf("number"),f.string=f.typeOf("string"),f.object=f.typeOf("object"),f.func=f.typeOf("function"),f.array=f.typeOf("array"),f.regexp=f.typeOf("regexp"),f.date=f.typeOf("date"),a.match=f,f}function e(a,c,d){var e=a("./util/core");a("./typeOf"),d.exports=b(e)}var c="undefined"!=typeof module&&module.exports&&"function"==typeof require,d="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(d)define(e);else if(c)e(require,module.exports,module);else{if(!a)return;b(a)}}("object"==typeof sinon&&sinon||null),function(a,b){function c(a){function c(a){return""+a}function d(){function c(){return a.ascii.apply(a,arguments)}var a=b.configure({quoteStrings:!1,limitChildrenCount:250});return c}function e(){function b(a){return"object"==typeof a&&a.toString===Object.prototype.toString?d.inspect(a):a}try{var d=require("util")}catch(e){}return d?b:c}var g,f="undefined"!=typeof module&&module.exports&&"function"==typeof require;if(f)try{b=require("formatio")}catch(h){}return g=b?d():f?e():c,a.format=g,a.format}function d(a,b,d){var e=a("./util/core");d.exports=c(e)}var e="undefined"!=typeof module&&module.exports&&"function"==typeof require,f="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(f)define(d);else if(e)d(require,module.exports,module);else{if(!a)return;c(a)}}("object"==typeof sinon&&sinon||null,"object"==typeof formatio&&formatio),function(a){function b(a){function b(b,d,e){var f=a.functionName(b)+d;throw e.length&&(f+=" Received ["+c.call(e).join(", ")+"]"),new Error(f)}function e(b,c,e,f,g,h){if("number"!=typeof h)throw new TypeError("Call id is not a number");var i=a.create(d);return i.proxy=b,i.thisValue=c,i.args=e,i.returnValue=f,i.exception=g,i.callId=h,i}var c=Array.prototype.slice,d={calledOn:function(b){return a.match&&a.match.isMatcher(b)?b.test(this.thisValue):this.thisValue===b},calledWith:function(){var b=arguments.length;if(b>this.args.length)return!1;for(var c=0;b>c;c+=1)if(!a.deepEqual(arguments[c],this.args[c]))return!1;return!0},calledWithMatch:function(){var b=arguments.length;if(b>this.args.length)return!1;for(var c=0;b>c;c+=1){var d=this.args[c],e=arguments[c];if(!a.match||!a.match(e).test(d))return!1}return!0},calledWithExactly:function(){return arguments.length==this.args.length&&this.calledWith.apply(this,arguments)},notCalledWith:function(){return!this.calledWith.apply(this,arguments)},notCalledWithMatch:function(){return!this.calledWithMatch.apply(this,arguments)},returned:function(b){return a.deepEqual(b,this.returnValue)},threw:function(a){return"undefined"!=typeof a&&this.exception?this.exception===a||this.exception.name===a:!!this.exception},calledWithNew:function(){return this.proxy.prototype&&this.thisValue instanceof this.proxy},calledBefore:function(a){return this.callId<a.callId},calledAfter:function(a){return this.callId>a.callId},callArg:function(a){this.args[a]()},callArgOn:function(a,b){this.args[a].apply(b)},callArgWith:function(a){this.callArgOnWith.apply(this,[a,null].concat(c.call(arguments,1)))},callArgOnWith:function(a,b){var d=c.call(arguments,2);this.args[a].apply(b,d)},yield:function(){this.yieldOn.apply(this,[null].concat(c.call(arguments,0)))},yieldOn:function(a){for(var d=this.args,e=0,f=d.length;f>e;++e)if("function"==typeof d[e])return d[e].apply(a,c.call(arguments,1)),void 0;b(this.proxy," cannot yield since no callback was passed.",d)},yieldTo:function(a){this.yieldToOn.apply(this,[a,null].concat(c.call(arguments,1)))},yieldToOn:function(a,d){for(var e=this.args,f=0,g=e.length;g>f;++f)if(e[f]&&"function"==typeof e[f][a])return e[f][a].apply(d,c.call(arguments,2)),void 0;b(this.proxy," cannot yield to '"+a+"' since no callback was passed.",e)},toString:function(){for(var b=this.proxy.toString()+"(",c=[],d=0,e=this.args.length;e>d;++d)c.push(a.format(this.args[d]));return b=b+c.join(", ")+")","undefined"!=typeof this.returnValue&&(b+=" => "+a.format(this.returnValue)),this.exception&&(b+=" !"+this.exception.name,this.exception.message&&(b+="("+this.exception.message+")")),b}};return d.invokeCallback=d.yield,e.toString=d.toString,a.spyCall=e,e}function e(a,c,d){var e=a("./util/core");a("./match"),a("./format"),d.exports=b(e)}var c="undefined"!=typeof module&&module.exports&&"function"==typeof require,d="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(d)define(e);else if(c)e(require,module.exports,module);else{if(!a)return;b(a)}}("object"==typeof sinon&&sinon||null),function(sinon){function makeApi(sinon){function spy(a,b,c){if(!b&&"function"==typeof a)return spy.create(a);if(!a&&!b)return spy.create(function(){});if(c){for(var d=sinon.getPropertyDescriptor(a,b),e=0;e<c.length;e++)d[c[e]]=spy.create(d[c[e]]);return sinon.wrapMethod(a,b,d)}var f=a[b];return sinon.wrapMethod(a,b,spy.create(f))}function matchingFake(a,b,c){if(a)for(var d=0,e=a.length;e>d;d++)if(a[d].matches(b,c))return a[d]}function incrementCallCount(){this.called=!0,this.callCount+=1,this.notCalled=!1,this.calledOnce=1==this.callCount,this.calledTwice=2==this.callCount,this.calledThrice=3==this.callCount}function createCallProperties(){this.firstCall=this.getCall(0),this.secondCall=this.getCall(1),this.thirdCall=this.getCall(2),this.lastCall=this.getCall(this.callCount-1)}function createProxy(func,proxyLength){var p;return proxyLength?eval("p = (function proxy("+vars.substring(0,2*proxyLength-1)+") { return p.invoke(func, this, slice.call(arguments)); });"):p=function(){return p.invoke(func,this,slice.call(arguments))},p}function delegateToCalls(a,b,c,d){spyApi[a]=function(){if(!this.called)return d?d.apply(this,arguments):!1;for(var e,f=0,g=0,h=this.callCount;h>g;g+=1)if(e=this.getCall(g),e[c||a].apply(e,arguments)&&(f+=1,b))return!0;return f===this.callCount}}var push=Array.prototype.push,slice=Array.prototype.slice,callId=0,vars="a,b,c,d,e,f,g,h,i,j,k,l",uuid=0,spyApi={reset:function(){if(this.invoking){var a=new Error("Cannot reset Sinon function while invoking it. Move the call to .reset outside of the callback.");throw a.name="InvalidResetException",a}if(this.called=!1,this.notCalled=!0,this.calledOnce=!1,this.calledTwice=!1,this.calledThrice=!1,this.callCount=0,this.firstCall=null,this.secondCall=null,this.thirdCall=null,this.lastCall=null,this.args=[],this.returnValues=[],this.thisValues=[],this.exceptions=[],this.callIds=[],this.fakes)for(var b=0;b<this.fakes.length;b++)this.fakes[b].reset();return this},create:function(a,b){var c;"function"!=typeof a?a=function(){}:c=sinon.functionName(a),b||(b=a.length);var d=createProxy(a,b);return sinon.extend(d,spy),delete d.create,sinon.extend(d,a),d.reset(),d.prototype=a.prototype,d.displayName=c||"spy",d.toString=sinon.functionToString,d.instantiateFake=sinon.spy.create,d.id="spy#"+uuid++,d},invoke:function(a,b,c){var e,f,d=matchingFake(this.fakes,c);incrementCallCount.call(this),push.call(this.thisValues,b),push.call(this.args,c),push.call(this.callIds,callId++),createCallProperties.call(this);try{this.invoking=!0,f=d?d.invoke(a,b,c):(this.func||a).apply(b,c);var g=this.getCall(this.callCount-1);g.calledWithNew()&&"object"!=typeof f&&(f=b)}catch(h){e=h}finally{delete this.invoking}if(push.call(this.exceptions,e),push.call(this.returnValues,f),createCallProperties.call(this),void 0!==e)throw e;return f},named:function(a){return this.displayName=a,this},getCall:function(a){return 0>a||a>=this.callCount?null:sinon.spyCall(this,this.thisValues[a],this.args[a],this.returnValues[a],this.exceptions[a],this.callIds[a])},getCalls:function(){var b,a=[];for(b=0;b<this.callCount;b++)a.push(this.getCall(b));return a},calledBefore:function(a){return this.called?a.called?this.callIds[0]<a.callIds[a.callIds.length-1]:!0:!1},calledAfter:function(a){return this.called&&a.called?this.callIds[this.callCount-1]>a.callIds[a.callCount-1]:!1},withArgs:function(){var a=slice.call(arguments);if(this.fakes){var b=matchingFake(this.fakes,a,!0);if(b)return b}else this.fakes=[];var c=this,d=this.instantiateFake();d.matchingAguments=a,d.parent=this,push.call(this.fakes,d),d.withArgs=function(){return c.withArgs.apply(c,arguments)};for(var e=0;e<this.args.length;e++)d.matches(this.args[e])&&(incrementCallCount.call(d),push.call(d.thisValues,this.thisValues[e]),push.call(d.args,this.args[e]),push.call(d.returnValues,this.returnValues[e]),push.call(d.exceptions,this.exceptions[e]),push.call(d.callIds,this.callIds[e]));return createCallProperties.call(d),d},matches:function(a,b){var c=this.matchingAguments;return c.length<=a.length&&sinon.deepEqual(c,a.slice(0,c.length))?!b||c.length==a.length:void 0},printf:function(a){var d,b=this,c=slice.call(arguments,1);return(a||"").replace(/%(.)/g,function(a,e){return d=spyApi.formatters[e],"function"==typeof d?d.call(null,b,c):isNaN(parseInt(e,10))?"%"+e:sinon.format(c[e-1])})}};return delegateToCalls("calledOn",!0),delegateToCalls("alwaysCalledOn",!1,"calledOn"),delegateToCalls("calledWith",!0),delegateToCalls("calledWithMatch",!0),delegateToCalls("alwaysCalledWith",!1,"calledWith"),delegateToCalls("alwaysCalledWithMatch",!1,"calledWithMatch"),delegateToCalls("calledWithExactly",!0),delegateToCalls("alwaysCalledWithExactly",!1,"calledWithExactly"),delegateToCalls("neverCalledWith",!1,"notCalledWith",function(){return!0}),delegateToCalls("neverCalledWithMatch",!1,"notCalledWithMatch",function(){return!0}),delegateToCalls("threw",!0),delegateToCalls("alwaysThrew",!1,"threw"),delegateToCalls("returned",!0),delegateToCalls("alwaysReturned",!1,"returned"),delegateToCalls("calledWithNew",!0),delegateToCalls("alwaysCalledWithNew",!1,"calledWithNew"),delegateToCalls("callArg",!1,"callArgWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgWith=spyApi.callArg,delegateToCalls("callArgOn",!1,"callArgOnWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgOnWith=spyApi.callArgOn,delegateToCalls("yield",!1,"yield",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")
}),spyApi.invokeCallback=spyApi.yield,delegateToCalls("yieldOn",!1,"yieldOn",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),delegateToCalls("yieldTo",!1,"yieldTo",function(a){throw new Error(this.toString()+" cannot yield to '"+a+"' since it was not yet invoked.")}),delegateToCalls("yieldToOn",!1,"yieldToOn",function(a){throw new Error(this.toString()+" cannot yield to '"+a+"' since it was not yet invoked.")}),spyApi.formatters={c:function(a){return sinon.timesInWords(a.callCount)},n:function(a){return a.toString()},C:function(a){for(var b=[],c=0,d=a.callCount;d>c;++c){var e="    "+a.getCall(c).toString();/\n/.test(b[c-1])&&(e="\n"+e),push.call(b,e)}return b.length>0?"\n"+b.join("\n"):""},t:function(a){for(var b=[],c=0,d=a.callCount;d>c;++c)push.call(b,sinon.format(a.thisValues[c]));return b.join(", ")},"*":function(a,b){for(var c=[],d=0,e=b.length;e>d;++d)push.call(c,sinon.format(b[d]));return c.join(", ")}},sinon.extend(spy,spyApi),spy.spyCall=sinon.spyCall,sinon.spy=spy,spy}function loadDependencies(a,b,c){var d=a("./util/core");a("./call"),a("./extend"),a("./times_in_words"),a("./format"),c.exports=makeApi(d)}var isNode="undefined"!=typeof module&&module.exports&&"function"==typeof require,isAMD="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(isAMD)define(loadDependencies);else if(isNode)loadDependencies(require,module.exports,module);else{if(!sinon)return;makeApi(sinon)}}("object"==typeof sinon&&sinon||null),function(a){function g(a,b){return"string"==typeof a?(this.exception=new Error(b||""),this.exception.name=a):this.exception=a?a:new Error("Error"),this}function h(a,c){var f=a.callArgAt;if(f>=0)return c[f];var g;f===d&&(g=c),f===e&&(g=b.call(c).reverse());for(var h=a.callArgProp,i=0,j=g.length;j>i;++i){if(!h&&"function"==typeof g[i])return g[i];if(h&&g[i]&&"function"==typeof g[i][h])return g[i][h]}return null}function i(a){function i(b,d,e){if(b.callArgAt<0){var f;return f=b.callArgProp?a.functionName(b.stub)+" expected to yield to '"+b.callArgProp+"', but no object with such a property was passed.":a.functionName(b.stub)+" expected to yield, but no callback was passed.",e.length>0&&(f+=" Received ["+c.call(e,", ")+"]"),f}return"argument at index "+b.callArgAt+" is not a function: "+d}function j(a,b){if("number"==typeof a.callArgAt){var c=h(a,b);if("function"!=typeof c)throw new TypeError(i(a,c,b));a.callbackAsync?f(function(){c.apply(a.callbackContext,a.callbackArguments)}):c.apply(a.callbackContext,a.callbackArguments)}}var k={create:function(b){var c=a.extend({},a.behavior);return delete c.create,c.stub=b,c},isPresent:function(){return"number"==typeof this.callArgAt||this.exception||"number"==typeof this.returnArgAt||this.returnThis||this.returnValueDefined},invoke:function(a,b){if(j(this,b),this.exception)throw this.exception;return"number"==typeof this.returnArgAt?b[this.returnArgAt]:this.returnThis?a:this.returnValue},onCall:function(a){return this.stub.onCall(a)},onFirstCall:function(){return this.stub.onFirstCall()},onSecondCall:function(){return this.stub.onSecondCall()},onThirdCall:function(){return this.stub.onThirdCall()},withArgs:function(){throw new Error('Defining a stub by invoking "stub.onCall(...).withArgs(...)" is not supported. Use "stub.withArgs(...).onCall(...)" to define sequential behavior for calls with certain arguments.')},callsArg:function(a){if("number"!=typeof a)throw new TypeError("argument index is not number");return this.callArgAt=a,this.callbackArguments=[],this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOn:function(a,b){if("number"!=typeof a)throw new TypeError("argument index is not number");if("object"!=typeof b)throw new TypeError("argument context is not an object");return this.callArgAt=a,this.callbackArguments=[],this.callbackContext=b,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgWith:function(a){if("number"!=typeof a)throw new TypeError("argument index is not number");return this.callArgAt=a,this.callbackArguments=b.call(arguments,1),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOnWith:function(a,c){if("number"!=typeof a)throw new TypeError("argument index is not number");if("object"!=typeof c)throw new TypeError("argument context is not an object");return this.callArgAt=a,this.callbackArguments=b.call(arguments,2),this.callbackContext=c,this.callArgProp=void 0,this.callbackAsync=!1,this},yields:function(){return this.callArgAt=d,this.callbackArguments=b.call(arguments,0),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsRight:function(){return this.callArgAt=e,this.callbackArguments=b.call(arguments,0),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsOn:function(a){if("object"!=typeof a)throw new TypeError("argument context is not an object");return this.callArgAt=d,this.callbackArguments=b.call(arguments,1),this.callbackContext=a,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsTo:function(a){return this.callArgAt=d,this.callbackArguments=b.call(arguments,1),this.callbackContext=void 0,this.callArgProp=a,this.callbackAsync=!1,this},yieldsToOn:function(a,c){if("object"!=typeof c)throw new TypeError("argument context is not an object");return this.callArgAt=d,this.callbackArguments=b.call(arguments,2),this.callbackContext=c,this.callArgProp=a,this.callbackAsync=!1,this},"throws":g,throwsException:g,returns:function(a){return this.returnValue=a,this.returnValueDefined=!0,this},returnsArg:function(a){if("number"!=typeof a)throw new TypeError("argument index is not number");return this.returnArgAt=a,this},returnsThis:function(){return this.returnThis=!0,this}};for(var l in k)k.hasOwnProperty(l)&&l.match(/^(callsArg|yields)/)&&!l.match(/Async/)&&(k[l+"Async"]=function(a){return function(){var b=this[a].apply(this,arguments);return this.callbackAsync=!0,b}}(l));return a.behavior=k,k}function l(a,b,c){var d=a("./util/core");a("./extend"),c.exports=i(d)}var b=Array.prototype.slice,c=Array.prototype.join,d=-1,e=-2,f=function(){return"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick:"function"==typeof setImmediate?setImmediate:function(a){setTimeout(a,0)}}(),j="undefined"!=typeof module&&module.exports&&"function"==typeof require,k="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(k)define(l);else if(j)l(require,module.exports,module);else{if(!a)return;i(a)}}("object"==typeof sinon&&sinon||null),function(a){function b(a){function b(c,d,e){if(e&&"function"!=typeof e&&"object"!=typeof e)throw new TypeError("Custom stub should be a function or a property descriptor");var f;if(e){if("function"==typeof e)f=a.spy&&a.spy.create?a.spy.create(e):e;else if(f=e,a.spy&&a.spy.create)for(var g=a.objectKeys(f),h=0;h<g.length;h++)f[g[h]]=a.spy.create(f[g[h]])}else{var i=0;"object"==typeof c&&"function"==typeof c[d]&&(i=c[d].length),f=b.create(i)}if(!c&&"undefined"==typeof d)return a.stub.create();if("undefined"==typeof d&&"object"==typeof c){for(var j in c)"function"==typeof c[j]&&b(c,j);return c}return a.wrapMethod(c,d,f)}function c(b){return b.defaultBehavior||d(b)||a.behavior.create(b)}function d(a){return a.parent&&e(a.parent)}function e(a){var b=a.behaviors[a.callCount-1];return b&&b.isPresent()?b:c(a)}var f=0,g={create:function(c){var d=function(){return e(d).invoke(this,arguments)};d.id="stub#"+f++;var g=d;return d=a.spy.create(d,c),d.func=g,a.extend(d,b),d.instantiateFake=a.stub.create,d.displayName="stub",d.toString=a.functionToString,d.defaultBehavior=null,d.behaviors=[],d},resetBehavior:function(){var a;if(this.defaultBehavior=null,this.behaviors=[],delete this.returnValue,delete this.returnArgAt,this.returnThis=!1,this.fakes)for(a=0;a<this.fakes.length;a++)this.fakes[a].resetBehavior()},onCall:function(b){return this.behaviors[b]||(this.behaviors[b]=a.behavior.create(this)),this.behaviors[b]},onFirstCall:function(){return this.onCall(0)},onSecondCall:function(){return this.onCall(1)},onThirdCall:function(){return this.onCall(2)}};for(var h in a.behavior)a.behavior.hasOwnProperty(h)&&!g.hasOwnProperty(h)&&"create"!=h&&"withArgs"!=h&&"invoke"!=h&&(g[h]=function(b){return function(){return this.defaultBehavior=this.defaultBehavior||a.behavior.create(this),this.defaultBehavior[b].apply(this.defaultBehavior,arguments),this}}(h));return a.extend(b,g),a.stub=b,b}function e(a,c,d){var e=a("./util/core");a("./behavior"),a("./spy"),a("./extend"),d.exports=b(e)}var c="undefined"!=typeof module&&module.exports&&"function"==typeof require,d="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(d)define(e);else if(c)e(require,module.exports,module);else{if(!a)return;b(a)}}("object"==typeof sinon&&sinon||null),function(a){function b(a){function d(b){return b?d.create(b):a.expectation.create("Anonymous mock")}function e(a,b){if(a)for(var c=0,d=a.length;d>c;c+=1)b(a[c])}function h(a){return 0==a?"never called":"called "+f(a)}function i(a){var b=a.minCalls,c=a.maxCalls;if("number"==typeof b&&"number"==typeof c){var d=f(b);return b!=c&&(d="at least "+d+" and at most "+f(c)),d}return"number"==typeof b?"at least "+f(b):"at most "+f(c)}function j(a){var b="number"==typeof a.minCalls;return!b||a.callCount>=a.minCalls}function k(a){return"number"!=typeof a.maxCalls?!1:a.callCount==a.maxCalls}function l(a,b){return c&&c.isMatcher(a)?a.test(b):!0}var b=[].push,c=a.match;a.extend(d,{create:function(b){if(!b)throw new TypeError("object is null");var c=a.extend({},d);return c.object=b,delete c.create,c},expects:function(c){if(!c)throw new TypeError("method is falsy");if(this.expectations||(this.expectations={},this.proxies=[]),!this.expectations[c]){this.expectations[c]=[];var d=this;a.wrapMethod(this.object,c,function(){return d.invokeMethod(c,this,arguments)}),b.call(this.proxies,c)}var e=a.expectation.create(c);return b.call(this.expectations[c],e),e},restore:function(){var a=this.object;e(this.proxies,function(b){"function"==typeof a[b].restore&&a[b].restore()})},verify:function(){var c=this.expectations||{},d=[],f=[];return e(this.proxies,function(a){e(c[a],function(a){a.met()?b.call(f,a.toString()):b.call(d,a.toString())})}),this.restore(),d.length>0?a.expectation.fail(d.concat(f).join("\n")):f.length>0&&a.expectation.pass(d.concat(f).join("\n")),!0},invokeMethod:function(c,d,e){var h,f=this.expectations&&this.expectations[c],g=f&&f.length||0;for(h=0;g>h;h+=1)if(!f[h].met()&&f[h].allowsCall(d,e))return f[h].apply(d,e);var j,i=[],k=0;for(h=0;g>h;h+=1)f[h].allowsCall(d,e)?j=j||f[h]:k+=1,b.call(i,"    "+f[h].toString());return 0===k?j.apply(d,e):(i.unshift("Unexpected call: "+a.spyCall.toString.call({proxy:c,args:e})),a.expectation.fail(i.join("\n")),void 0)}});var f=a.timesInWords,g=Array.prototype.slice;return a.expectation={minCalls:1,maxCalls:1,create:function(b){var c=a.extend(a.stub.create(),a.expectation);return delete c.create,c.method=b,c},invoke:function(b,c,d){return this.verifyCallAllowed(c,d),a.spy.invoke.apply(this,arguments)},atLeast:function(a){if("number"!=typeof a)throw new TypeError("'"+a+"' is not number");return this.limitsSet||(this.maxCalls=null,this.limitsSet=!0),this.minCalls=a,this},atMost:function(a){if("number"!=typeof a)throw new TypeError("'"+a+"' is not number");return this.limitsSet||(this.minCalls=null,this.limitsSet=!0),this.maxCalls=a,this},never:function(){return this.exactly(0)},once:function(){return this.exactly(1)},twice:function(){return this.exactly(2)},thrice:function(){return this.exactly(3)},exactly:function(a){if("number"!=typeof a)throw new TypeError("'"+a+"' is not a number");return this.atLeast(a),this.atMost(a)},met:function(){return!this.failed&&j(this)},verifyCallAllowed:function(b,c){if(k(this)&&(this.failed=!0,a.expectation.fail(this.method+" already called "+f(this.maxCalls))),"expectedThis"in this&&this.expectedThis!==b&&a.expectation.fail(this.method+" called with "+b+" as thisValue, expected "+this.expectedThis),"expectedArguments"in this){c||a.expectation.fail(this.method+" received no arguments, expected "+a.format(this.expectedArguments)),c.length<this.expectedArguments.length&&a.expectation.fail(this.method+" received too few arguments ("+a.format(c)+"), expected "+a.format(this.expectedArguments)),this.expectsExactArgCount&&c.length!=this.expectedArguments.length&&a.expectation.fail(this.method+" received too many arguments ("+a.format(c)+"), expected "+a.format(this.expectedArguments));for(var d=0,e=this.expectedArguments.length;e>d;d+=1)l(this.expectedArguments[d],c[d])||a.expectation.fail(this.method+" received wrong arguments "+a.format(c)+", didn't match "+this.expectedArguments.toString()),a.deepEqual(this.expectedArguments[d],c[d])||a.expectation.fail(this.method+" received wrong arguments "+a.format(c)+", expected "+a.format(this.expectedArguments))}},allowsCall:function(b,c){if(this.met()&&k(this))return!1;if("expectedThis"in this&&this.expectedThis!==b)return!1;if(!("expectedArguments"in this))return!0;if(c=c||[],c.length<this.expectedArguments.length)return!1;if(this.expectsExactArgCount&&c.length!=this.expectedArguments.length)return!1;for(var d=0,e=this.expectedArguments.length;e>d;d+=1){if(!l(this.expectedArguments[d],c[d]))return!1;if(!a.deepEqual(this.expectedArguments[d],c[d]))return!1}return!0},withArgs:function(){return this.expectedArguments=g.call(arguments),this},withExactArgs:function(){return this.withArgs.apply(this,arguments),this.expectsExactArgCount=!0,this},on:function(a){return this.expectedThis=a,this},toString:function(){var c=(this.expectedArguments||[]).slice();this.expectsExactArgCount||b.call(c,"[...]");var d=a.spyCall.toString.call({proxy:this.method||"anonymous mock expectation",args:c}),e=d.replace(", [...","[, ...")+" "+i(this);return this.met()?"Expectation met: "+e:"Expected "+e+" ("+h(this.callCount)+")"},verify:function(){return this.met()?a.expectation.pass(this.toString()):a.expectation.fail(this.toString()),!0},pass:function(b){a.assert.pass(b)},fail:function(a){var b=new Error(a);throw b.name="ExpectationError",b}},a.mock=d,d}function e(a,c,d){var e=a("./util/core");a("./times_in_words"),a("./call"),a("./extend"),a("./match"),a("./spy"),a("./stub"),a("./format"),d.exports=b(e)}var c="undefined"!=typeof module&&module.exports&&"function"==typeof require,d="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(d)define(e);else if(c)e(require,module.exports,module);else{if(!a)return;b(a)}}("object"==typeof sinon&&sinon||null),function(a){function d(a){return a.fakes||(a.fakes=[]),a.fakes}function e(a,b){for(var c=d(a),e=0,f=c.length;f>e;e+=1)"function"==typeof c[e][b]&&c[e][b]()}function f(a){for(var b=d(a),c=0;c<b.length;)b.splice(c,1)}function g(a){var g={verify:function(){e(this,"verify")},restore:function(){e(this,"restore"),f(this)},reset:function(){e(this,"reset")},verifyAndRestore:function(){var a;try{this.verify()}catch(b){a=b}if(this.restore(),a)throw a},add:function(a){return b.call(d(this),a),a},spy:function(){return this.add(a.spy.apply(a,arguments))},stub:function(b,d,e){if(d){var f=b[d];if("function"!=typeof f){if(!c.call(b,d))throw new TypeError("Cannot stub non-existent own property "+d);return b[d]=e,this.add({restore:function(){b[d]=f}})}}if(!d&&b&&"object"==typeof b){var g=a.stub.apply(a,arguments);for(var h in g)"function"==typeof g[h]&&this.add(g[h]);return g}return this.add(a.stub.apply(a,arguments))},mock:function(){return this.add(a.mock.apply(a,arguments))},inject:function(a){var b=this;return a.spy=function(){return b.spy.apply(b,arguments)},a.stub=function(){return b.stub.apply(b,arguments)},a.mock=function(){return b.mock.apply(b,arguments)},a}};return a.collection=g,g}function j(a,b,c){var d=a("./util/core");a("./mock"),a("./spy"),a("./stub"),c.exports=g(d)}var b=[].push,c=Object.prototype.hasOwnProperty,h="undefined"!=typeof module&&module.exports&&"function"==typeof require,i="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(i)define(j);else if(h)j(require,module.exports,module);else{if(!a)return;g(a)}}("object"==typeof sinon&&sinon||null),"undefined"==typeof sinon)var sinon={};if(function(){function b(a,b){var c="undefined"!=typeof lolex?lolex:b;a.useFakeTimers=function(){var a,b=Array.prototype.slice.call(arguments);a="string"==typeof b[0]?0:b.shift();var d=c.install(a||0,b);return d.restore=d.uninstall,d},a.clock={create:function(a){return c.createClock(a)}},a.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:"undefined"!=typeof setImmediate?setImmediate:void 0,clearImmediate:"undefined"!=typeof clearImmediate?clearImmediate:void 0,setInterval:setInterval,clearInterval:clearInterval,Date:Date}}function e(a,c,d,e){var f=a("./core");b(f,e),d.exports=f}var c="undefined"!=typeof module&&module.exports&&"function"==typeof require,d="function"==typeof define&&"object"==typeof define.amd&&define.amd;d?define(e):c?e(require,module.exports,module,require("lolex")):b(sinon)}("undefined"!=typeof global&&"function"!=typeof global?global:this),"undefined"==typeof sinon&&(this.sinon={}),function(){function b(b){b.Event=function(a,b,c,d){this.initEvent(a,b,c,d)},b.Event.prototype={initEvent:function(a,b,c,d){this.type=a,this.bubbles=b,this.cancelable=c,this.target=d},stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}},b.ProgressEvent=function(a,b,c){this.initEvent(a,!1,!1,c),this.loaded=b.loaded||null,this.total=b.total||null,this.lengthComputable=!!b.total},b.ProgressEvent.prototype=new b.Event,b.ProgressEvent.prototype.constructor=b.ProgressEvent,b.CustomEvent=function(a,b,c){this.initEvent(a,!1,!1,c),this.detail=b.detail||null},b.CustomEvent.prototype=new b.Event,b.CustomEvent.prototype.constructor=b.CustomEvent,b.EventTarget={addEventListener:function(b,c){this.eventListeners=this.eventListeners||{},this.eventListeners[b]=this.eventListeners[b]||[],a.call(this.eventListeners[b],c)},removeEventListener:function(a,b){for(var c=this.eventListeners&&this.eventListeners[a]||[],d=0,e=c.length;e>d;++d)if(c[d]==b)return c.splice(d,1)},dispatchEvent:function(a){for(var b=a.type,c=this.eventListeners&&this.eventListeners[b]||[],d=0;d<c.length;d++)"function"==typeof c[d]?c[d].call(this,a):c[d].handleEvent(a);return!!a.defaultPrevented}}}function e(a){var c=a("./core");b(c)}var a=[].push,c="undefined"!=typeof module&&module.exports&&"function"==typeof require,d="function"==typeof define&&"object"==typeof define.amd&&define.amd;d?define(e):c?e(require):b(sinon)}(),function(a){function c(a){function c(){}function d(b,c){var e=b+" threw exception: ";a.log(e+"["+c.name+"] "+c.message),c.stack&&a.log(c.stack),d.setTimeout(function(){throw c.message=e+c.message,c},0)}d.setTimeout=function(a,c){b(a,c)};var e={};return e.log=a.log=c,e.logError=a.logError=d,e}function d(a,b,d){var e=a("./util/core");d.exports=c(e)}var b=setTimeout,e="undefined"!=typeof module&&module.exports&&"function"==typeof require,f="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(f)define(d);else if(e)d(require,module.exports,module);else{if(!a)return;c(a)}}("object"==typeof sinon&&sinon||null),"undefined"==typeof sinon&&(this.sinon={}),function(a){function c(c){function d(){this.readyState=d.UNSENT,this.requestBody=null,this.requestHeaders={},this.status=0,this.timeout=null,"function"==typeof d.onCreate&&d.onCreate(this)}function e(a){if(a.readyState!==d.OPENED)throw new Error("INVALID_STATE_ERR");if(a.sendFlag)throw new Error("INVALID_STATE_ERR")}function f(a){if(a.readyState==d.UNSENT)throw new Error("Request not sent");if(a.readyState==d.DONE)throw new Error("Request done")}function g(a){if("string"!=typeof a){var b=new Error("Attempted to respond to fake XDomainRequest with "+a+", which is not a string.");throw b.name="InvalidBodyException",b}}c.xdr=b,c.extend(d.prototype,c.EventTarget,{open:function(a,b){this.method=a,this.url=b,this.responseText=null,this.sendFlag=!1,this.readyStateChange(d.OPENED)},readyStateChange:function(a){this.readyState=a;var b="";switch(this.readyState){case d.UNSENT:break;case d.OPENED:break;case d.LOADING:this.sendFlag&&(b="onprogress");break;case d.DONE:b=this.isTimeout?"ontimeout":this.errorFlag||this.status<200||this.status>299?"onerror":"onload"}if(b&&"function"==typeof this[b])try{this[b]()}catch(e){c.logError("Fake XHR "+b+" handler",e)}},send:function(a){e(this),/^(get|head)$/i.test(this.method)||(this.requestBody=a),this.requestHeaders["Content-Type"]="text/plain;charset=utf-8",this.errorFlag=!1,this.sendFlag=!0,this.readyStateChange(d.OPENED),"function"==typeof this.onSend&&this.onSend(this)},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.readyState>c.FakeXDomainRequest.UNSENT&&this.sendFlag&&(this.readyStateChange(c.FakeXDomainRequest.DONE),this.sendFlag=!1)},setResponseBody:function(a){f(this),g(a);var b=this.chunkSize||10,c=0;this.responseText="";do this.readyStateChange(d.LOADING),this.responseText+=a.substring(c,c+b),c+=b;while(c<a.length);this.readyStateChange(d.DONE)},respond:function(a,b,c){this.status="number"==typeof a?a:200,this.setResponseBody(c||"")},simulatetimeout:function(){this.status=0,this.isTimeout=!0,this.responseText=void 0,this.readyStateChange(d.DONE)}}),c.extend(d,{UNSENT:0,OPENED:1,LOADING:3,DONE:4}),c.useFakeXDomainRequest=function(){return c.FakeXDomainRequest.restore=function(d){b.supportsXDR&&(a.XDomainRequest=b.GlobalXDomainRequest),delete c.FakeXDomainRequest.restore,d!==!0&&delete c.FakeXDomainRequest.onCreate},b.supportsXDR&&(a.XDomainRequest=c.FakeXDomainRequest),c.FakeXDomainRequest},c.FakeXDomainRequest=d}function f(a,b,d){var e=a("./core");a("../extend"),a("./event"),a("../log_error"),c(e),d.exports=e}var b={XDomainRequest:a.XDomainRequest};b.GlobalXDomainRequest=a.XDomainRequest,b.supportsXDR="undefined"!=typeof b.GlobalXDomainRequest,b.workingXDR=b.supportsXDR?b.GlobalXDomainRequest:!1;var d="undefined"!=typeof module&&module.exports&&"function"==typeof require,e="function"==typeof define&&"object"==typeof define.amd&&define.amd;e?define(f):d?f(require,module.exports,module):c(sinon)}(this),function(a){function f(){function c(b){a.addEventListener(b,function(c){var d=a["on"+b];d&&"function"==typeof d&&d.call(this,c)})}this.readyState=f.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="",this.upload=new g,d.supportsCORS&&(this.withCredentials=!1);for(var a=this,b=["loadstart","load","abort","loadend"],e=b.length-1;e>=0;e--)c(b[e]);"function"==typeof f.onCreate&&f.onCreate(this)}function g(){this.eventListeners={progress:[],load:[],abort:[],error:[]}}function h(a){if(a.readyState!==f.OPENED)throw new Error("INVALID_STATE_ERR");if(a.sendFlag)throw new Error("INVALID_STATE_ERR")}function i(a,b){b=b.toLowerCase();for(var c in a)if(c.toLowerCase()==b)return c;return null}function j(a,b){if(a)for(var c=0,d=a.length;d>c;c+=1)b(a[c])}function k(a,b){for(var c=0;c<a.length;c++)if(b(a[c])===!0)return!0;return!1}function n(a){if(a.readyState!=f.OPENED)throw new Error("INVALID_STATE_ERR - "+a.readyState)}function o(a){if(a.readyState==f.DONE)throw new Error("Request done")}function p(a){if(a.async&&a.readyState!=f.HEADERS_RECEIVED)throw new Error("No headers received")}function q(a){if("string"!=typeof a){var b=new Error("Attempted to respond to fake XMLHttpRequest with "+a+", which is not a string.");throw b.name="InvalidBodyException",b}}function r(g){g.xhr=d,g.extend(f.prototype,g.EventTarget,{async:!0,open:function(a,b,c,d,e){if(this.method=a,this.url=b,this.async="boolean"==typeof c?c:!0,this.username=d,this.password=e,this.responseText=null,this.responseXML=null,this.requestHeaders={},this.sendFlag=!1,f.useFilters===!0){var g=arguments,h=k(f.filters,function(a){return a.apply(this,g)});if(h)return f.defake(this,arguments)}this.readyStateChange(f.OPENED)},readyStateChange:function(a){if(this.readyState=a,"function"==typeof this.onreadystatechange)try{this.onreadystatechange()}catch(c){g.logError("Fake XHR onreadystatechange handler",c)}switch(this.dispatchEvent(new g.Event("readystatechange")),this.readyState){case f.DONE:this.dispatchEvent(new g.Event("load",!1,!1,this)),this.dispatchEvent(new g.Event("loadend",!1,!1,this)),this.upload.dispatchEvent(new g.Event("load",!1,!1,this)),b&&(this.upload.dispatchEvent(new g.ProgressEvent("progress",{loaded:100,total:100})),this.dispatchEvent(new g.ProgressEvent("progress",{loaded:100,total:100})))}},setRequestHeader:function(a,b){if(h(this),e[a]||/^(Sec-|Proxy-)/.test(a))throw new Error('Refused to set unsafe header "'+a+'"');this.requestHeaders[a]?this.requestHeaders[a]+=","+b:this.requestHeaders[a]=b},setResponseHeaders:function(a){n(this),this.responseHeaders={};for(var b in a)a.hasOwnProperty(b)&&(this.responseHeaders[b]=a[b]);this.async?this.readyStateChange(f.HEADERS_RECEIVED):this.readyState=f.HEADERS_RECEIVED},send:function(a){if(h(this),!/^(get|head)$/i.test(this.method)){var b=i(this.requestHeaders,"Content-Type");if(this.requestHeaders[b]){var c=this.requestHeaders[b].split(";");this.requestHeaders[b]=c[0]+";charset=utf-8"}else a instanceof FormData||(this.requestHeaders["Content-Type"]="text/plain;charset=utf-8");this.requestBody=a}this.errorFlag=!1,this.sendFlag=this.async,this.readyStateChange(f.OPENED),"function"==typeof this.onSend&&this.onSend(this),this.dispatchEvent(new g.Event("loadstart",!1,!1,this))},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>f.UNSENT&&this.sendFlag&&(this.readyStateChange(f.DONE),this.sendFlag=!1),this.readyState=f.UNSENT,this.dispatchEvent(new g.Event("abort",!1,!1,this)),this.upload.dispatchEvent(new g.Event("abort",!1,!1,this)),"function"==typeof this.onerror&&this.onerror()},getResponseHeader:function(a){return this.readyState<f.HEADERS_RECEIVED?null:/^Set-Cookie2?$/i.test(a)?null:(a=i(this.responseHeaders,a),this.responseHeaders[a]||null)},getAllResponseHeaders:function(){if(this.readyState<f.HEADERS_RECEIVED)return"";var a="";for(var b in this.responseHeaders)this.responseHeaders.hasOwnProperty(b)&&!/^Set-Cookie2?$/i.test(b)&&(a+=b+": "+this.responseHeaders[b]+"\r\n");return a},setResponseBody:function(a){o(this),p(this),q(a);var b=this.chunkSize||10,c=0;this.responseText="";do this.async&&this.readyStateChange(f.LOADING),this.responseText+=a.substring(c,c+b),c+=b;while(c<a.length);var d=this.getResponseHeader("Content-Type");if(this.responseText&&(!d||/(text\/xml)|(application\/xml)|(\+xml)/.test(d)))try{this.responseXML=f.parseXML(this.responseText)}catch(e){}this.readyStateChange(f.DONE)},respond:function(a,b,c){this.status="number"==typeof a?a:200,this.statusText=f.statusCodes[this.status],this.setResponseHeaders(b||{}),this.setResponseBody(c||"")},uploadProgress:function(a){b&&this.upload.dispatchEvent(new g.ProgressEvent("progress",a))},downloadProgress:function(a){b&&this.dispatchEvent(new g.ProgressEvent("progress",a))},uploadError:function(a){c&&this.upload.dispatchEvent(new g.CustomEvent("error",{detail:a}))}}),g.extend(f,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),g.useFakeXMLHttpRequest=function(){return f.restore=function(b){d.supportsXHR&&(a.XMLHttpRequest=d.GlobalXMLHttpRequest),d.supportsActiveX&&(a.ActiveXObject=d.GlobalActiveXObject),delete f.restore,b!==!0&&delete f.onCreate},d.supportsXHR&&(a.XMLHttpRequest=f),d.supportsActiveX&&(a.ActiveXObject=function(a){return"Microsoft.XMLHTTP"==a||/^Msxml2\.XMLHTTP/i.test(a)?new f:new d.GlobalActiveXObject(a)}),f},g.FakeXMLHttpRequest=f}function u(a,b,c){var d=a("./core");a("../extend"),a("./event"),a("../log_error"),r(d),c.exports=d}var b="undefined"!=typeof ProgressEvent,c="undefined"!=typeof CustomEvent,d={XMLHttpRequest:a.XMLHttpRequest};d.GlobalXMLHttpRequest=a.XMLHttpRequest,d.GlobalActiveXObject=a.ActiveXObject,d.supportsActiveX="undefined"!=typeof d.GlobalActiveXObject,d.supportsXHR="undefined"!=typeof d.GlobalXMLHttpRequest,d.workingXHR=d.supportsXHR?d.GlobalXMLHttpRequest:d.supportsActiveX?function(){return new d.GlobalActiveXObject("MSXML2.XMLHTTP.3.0")}:!1,d.supportsCORS=d.supportsXHR&&"withCredentials"in new d.GlobalXMLHttpRequest;var e={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};g.prototype.addEventListener=function(a,b){this.eventListeners[a].push(b)},g.prototype.removeEventListener=function(a,b){for(var c=this.eventListeners[a]||[],d=0,e=c.length;e>d;++d)if(c[d]==b)return c.splice(d,1)},g.prototype.dispatchEvent=function(a){for(var d,b=this.eventListeners[a.type]||[],c=0;null!=(d=b[c]);c++)d(a)};var l=function(a,b,c){switch(c.length){case 0:return a[b]();case 1:return a[b](c[0]);case 2:return a[b](c[0],c[1]);case 3:return a[b](c[0],c[1],c[2]);case 4:return a[b](c[0],c[1],c[2],c[3]);case 5:return a[b](c[0],c[1],c[2],c[3],c[4])}};f.filters=[],f.addFilter=function(a){this.filters.push(a)};var m=/MSIE 6/;f.defake=function(a,b){var c=new d.workingXHR;j(["open","setRequestHeader","send","abort","getResponseHeader","getAllResponseHeaders","addEventListener","overrideMimeType","removeEventListener"],function(b){a[b]=function(){return l(c,b,arguments)}});var e=function(b){j(b,function(b){try{a[b]=c[b]}catch(d){if(!m.test(navigator.userAgent))throw d}})},g=function(){a.readyState=c.readyState,c.readyState>=f.HEADERS_RECEIVED&&e(["status","statusText"]),c.readyState>=f.LOADING&&e(["responseText","response"]),c.readyState===f.DONE&&e(["responseXML"]),a.onreadystatechange&&a.onreadystatechange.call(a,{target:a})};if(c.addEventListener){for(var h in a.eventListeners)a.eventListeners.hasOwnProperty(h)&&j(a.eventListeners[h],function(a){c.addEventListener(h,a)});c.addEventListener("readystatechange",g)}else c.onreadystatechange=g;l(c,"open",b)},f.useFilters=!1,f.parseXML=function(a){var b;if("undefined"!=typeof DOMParser){var c=new DOMParser;b=c.parseFromString(a,"text/xml")}else b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a);return b},f.statusCodes={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};var s="undefined"!=typeof module&&module.exports&&"function"==typeof require,t="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(t)define(u);else if(s)u(require,module.exports,module);else{if("undefined"==typeof sinon)return;r(sinon)}}("undefined"!=typeof global?global:this),"undefined"==typeof sinon)var sinon={};return function(){function b(){}function c(a){return b.prototype=a,new b}function d(a){var b=a;if("[object Array]"!=Object.prototype.toString.call(a)&&(b=[200,{},a]),"string"!=typeof b[2])throw new TypeError("Fake server response body should be string, but was "+typeof b[2]);return b}function g(a,b,c){var d=a.method,e=!d||d.toLowerCase()==b.toLowerCase(),f=a.url,g=!f||f==c||"function"==typeof f.test&&f.test(c);return e&&g}function h(a,b){var c=b.url;if((!/^https?:\/\//.test(c)||f.test(c))&&(c=c.replace(f,"")),g(a,this.getHTTPMethod(b),c)){if("function"==typeof a.response){var d=a.url,e=[b].concat(d&&"function"==typeof d.exec?d.exec(c).slice(1):[]);
return a.response.apply(a,e)}return!0}return!1}function i(b){b.fakeServer={create:function(){var a=c(this);return this.xhr=b.xhr.supportsCORS?b.useFakeXMLHttpRequest():b.useFakeXDomainRequest(),a.requests=[],this.xhr.onCreate=function(b){a.addRequest(b)},a},addRequest:function(b){var c=this;a.call(this.requests,b),b.onSend=function(){c.handleRequest(this),c.respondImmediately?c.respond():c.autoRespond&&!c.responding&&(setTimeout(function(){c.responding=!1,c.respond()},c.autoRespondAfter||10),c.responding=!0)}},getHTTPMethod:function(a){if(this.fakeHTTPMethods&&/post/i.test(a.method)){var b=(a.requestBody||"").match(/_method=([^\b;]+)/);return b?b[1]:a.method}return a.method},handleRequest:function(b){b.async?(this.queue||(this.queue=[]),a.call(this.queue,b)):this.processRequest(b)},log:function(a,c){var d;d="Request:\n"+b.format(c)+"\n\n",d+="Response:\n"+b.format(a)+"\n\n",b.log(d)},respondWith:function(b,c,e){return 1==arguments.length&&"function"!=typeof b?(this.response=d(b),void 0):(this.responses||(this.responses=[]),1==arguments.length&&(e=b,c=b=null),2==arguments.length&&(e=c,c=b,b=null),a.call(this.responses,{method:b,url:c,response:"function"==typeof e?e:d(e)}),void 0)},respond:function(){arguments.length>0&&this.respondWith.apply(this,arguments);for(var c,a=this.queue||[],b=a.splice(0,a.length);c=b.shift();)this.processRequest(c)},processRequest:function(a){try{if(a.aborted)return;var c=this.response||[404,{},""];if(this.responses)for(var d=this.responses.length,e=d-1;e>=0;e--)if(h.call(this,this.responses[e],a)){c=this.responses[e].response;break}4!=a.readyState&&(this.log(c,a),a.respond(c[0],c[1],c[2]))}catch(f){b.logError("Fake server request processing",f)}},restore:function(){return this.xhr.restore&&this.xhr.restore.apply(this.xhr,arguments)}}}function l(a,b,c){var d=a("./core");a("./fake_xdomain_request"),a("./fake_xml_http_request"),a("../format"),i(d),c.exports=d}var a=[].push,e="undefined"!=typeof window?window.location:{},f=new RegExp("^"+e.protocol+"//"+e.host),j="undefined"!=typeof module&&module.exports&&"function"==typeof require,k="function"==typeof define&&"object"==typeof define.amd&&define.amd;k?define(l):j?l(require,module.exports,module):i(sinon)}(),function(){function a(a){function b(){}b.prototype=a.fakeServer,a.fakeServerWithClock=new b,a.fakeServerWithClock.addRequest=function(b){if(b.async&&("object"==typeof setTimeout.clock?this.clock=setTimeout.clock:(this.clock=a.useFakeTimers(),this.resetClock=!0),!this.longestTimeout)){var c=this.clock.setTimeout,d=this.clock.setInterval,e=this;this.clock.setTimeout=function(a,b){return e.longestTimeout=Math.max(b,e.longestTimeout||0),c.apply(this,arguments)},this.clock.setInterval=function(a,b){return e.longestTimeout=Math.max(b,e.longestTimeout||0),d.apply(this,arguments)}}return a.fakeServer.addRequest.call(this,b)},a.fakeServerWithClock.respond=function(){var b=a.fakeServer.respond.apply(this,arguments);return this.clock&&(this.clock.tick(this.longestTimeout||0),this.longestTimeout=0,this.resetClock&&(this.clock.restore(),this.resetClock=!1)),b},a.fakeServerWithClock.restore=function(){return this.clock&&this.clock.restore(),a.fakeServer.restore.apply(this,arguments)}}function d(b){var c=b("./core");b("./fake_server"),b("./fake_timers"),a(c)}var b="undefined"!=typeof module&&module.exports&&"function"==typeof require,c="function"==typeof define&&"object"==typeof define.amd&&define.amd;c?define(d):b?d(require):a(sinon)}(),function(){function a(a){function c(a,c,d,e){e&&(!c.injectInto||d in c.injectInto?b.call(a.args,e):(c.injectInto[d]=e,a.injectedKeys.push(d)))}function d(b){var c=a.create(a.sandbox);return b.useFakeServer&&("object"==typeof b.useFakeServer&&(c.serverPrototype=b.useFakeServer),c.useFakeServer()),b.useFakeTimers&&("object"==typeof b.useFakeTimers?c.useFakeTimers.apply(c,b.useFakeTimers):c.useFakeTimers()),c}var b=[].push;return a.sandbox=a.extend(a.create(a.collection),{useFakeTimers:function(){return this.clock=a.useFakeTimers.apply(a,arguments),this.add(this.clock)},serverPrototype:a.fakeServer,useFakeServer:function(){var b=this.serverPrototype||a.fakeServer;return b&&b.create?(this.server=b.create(),this.add(this.server)):null},inject:function(b){return a.collection.inject.call(this,b),this.clock&&(b.clock=this.clock),this.server&&(b.server=this.server,b.requests=this.server.requests),b.match=a.match,b},restore:function(){a.collection.restore.apply(this,arguments),this.restoreContext()},restoreContext:function(){if(this.injectedKeys){for(var a=0,b=this.injectedKeys.length;b>a;a++)delete this.injectInto[this.injectedKeys[a]];this.injectedKeys=[]}},create:function(b){if(!b)return a.create(a.sandbox);var e=d(b);e.args=e.args||[],e.injectedKeys=[],e.injectInto=b.injectInto;var f,g,h=e.inject({});if(b.properties)for(var i=0,j=b.properties.length;j>i;i++)f=b.properties[i],g=h[f]||"sandbox"==f&&e,c(e,b,f,g);else c(e,b,"sandbox",g);return e},match:a.match}),a.sandbox.useFakeXMLHttpRequest=a.sandbox.useFakeServer,a.sandbox}function d(b,c,d){var e=b("./util/core");b("./extend"),b("./util/fake_server_with_clock"),b("./util/fake_timers"),b("./collection"),d.exports=a(e)}var b="undefined"!=typeof module&&module.exports&&"function"==typeof require,c="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(c)define(d);else if(b)d(require,module.exports,module);else{if(!sinon)return;a(sinon)}}(),function(a){function b(a){function c(c){function e(){var d=a.getConfig(a.config);d.injectInto=d.injectIntoThis&&this||d.injectInto;var h,i,e=a.sandbox.create(d),f=b.call(arguments),g=f.length&&f[f.length-1];"function"==typeof g&&(f[f.length-1]=function(a){if(a)throw e.restore(),h;e.verifyAndRestore(),g(a)});try{i=c.apply(this,f.concat(e.args))}catch(j){h=j}if("function"!=typeof g){if("undefined"!=typeof h)throw e.restore(),h;e.verifyAndRestore()}return i}var d=typeof c;if("function"!=d)throw new TypeError("sinon.test needs to wrap a test function, got "+d);return c.length?function(){return e.apply(this,arguments)}:e}var b=Array.prototype.slice;return c.config={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},a.test=c,c}function e(a,c,d){var e=a("./util/core");a("./sandbox"),d.exports=b(e)}var c="undefined"!=typeof module&&module.exports&&"function"==typeof require,d="function"==typeof define&&"object"==typeof define.amd&&define.amd;d?define(e):c?e(require,module.exports,module):a&&b(a)}("object"==typeof sinon&&sinon||null),function(a){function b(a,b,c){return function(){b&&b.apply(this,arguments);var d,e;try{e=a.apply(this,arguments)}catch(f){d=f}if(c&&c.apply(this,arguments),d)throw d;return e}}function c(a){function c(c,d){if(!c||"object"!=typeof c)throw new TypeError("sinon.testCase needs an object with test functions");d=d||"test";var g,h,i,e=new RegExp("^"+d),f={},j=c.setUp,k=c.tearDown;for(g in c)if(c.hasOwnProperty(g)){if(h=c[g],/^(setUp|tearDown)$/.test(g))continue;"function"==typeof h&&e.test(g)?(i=h,(j||k)&&(i=b(h,j,k)),f[g]=a.test(i)):f[g]=c[g]}return f}return a.testCase=c,c}function f(a,b,d){var e=a("./util/core");a("./test"),d.exports=c(e)}var d="undefined"!=typeof module&&module.exports&&"function"==typeof require,e="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(e)define(f);else if(d)f(require,module.exports,module);else{if(!a)return;c(a)}}("object"==typeof sinon&&sinon||null),function(a,b){function d(a){function e(){for(var a,b=0,c=arguments.length;c>b;++b)a=arguments[b],a||d.fail("fake is not a spy"),a.proxy?e(a.proxy):("function"!=typeof a&&d.fail(a+" is not a function"),"function"!=typeof a.getCall&&d.fail(a+" is not stubbed"))}function f(a,c){a=a||b;var e=a.fail||d.fail;e.call(a,c)}function g(a,b,g){2==arguments.length&&(g=b,b=a),d[a]=function(h){e(h);var i=c.call(arguments,1),j=!1;j="function"==typeof b?!b(h):"function"==typeof h[b]?!h[b].apply(h,i):!h[b],j?f(this,(h.printf||h.proxy.printf).apply(h,[g].concat(i))):d.pass(a)}}function h(a,b){return!a||/^fail/.test(b)?b:a+b.slice(0,1).toUpperCase()+b.slice(1)}var d;return d={failException:"AssertError",fail:function(a){var b=new Error(a);throw b.name=this.failException||d.failException,b},pass:function(){},callOrder:function(){e.apply(null,arguments);var b="",g="";if(a.calledInOrder(arguments))d.pass("callOrder");else{try{b=[].join.call(arguments,", ");for(var h=c.call(arguments),i=h.length;i;)h[--i].called||h.splice(i,1);g=a.orderByFirstCall(h).join(", ")}catch(j){}f(this,"expected "+b+" to be "+"called in order but were called as "+g)}},callCount:function(b,c){if(e(b),b.callCount!=c){var g="expected %n to be called "+a.timesInWords(c)+" but was called %c%C";f(this,b.printf(g))}else d.pass("callCount")},expose:function(a,b){if(!a)throw new TypeError("target is null or undefined");var c=b||{},d="undefined"==typeof c.prefix&&"assert"||c.prefix,e="undefined"==typeof c.includeFail||!!c.includeFail;for(var f in this)"expose"==f||!e&&/^(fail)/.test(f)||(a[h(d,f)]=this[f]);return a},match:function(b,c){var e=a.match(c);if(e.test(b))d.pass("match");else{var g=["expected value to match","    expected = "+a.format(c),"    actual = "+a.format(b)];f(this,g.join("\n"))}}},g("called","expected %n to have been called at least once but was never called"),g("notCalled",function(a){return!a.called},"expected %n to not have been called but was called %c%C"),g("calledOnce","expected %n to be called once but was called %c%C"),g("calledTwice","expected %n to be called twice but was called %c%C"),g("calledThrice","expected %n to be called thrice but was called %c%C"),g("calledOn","expected %n to be called with %1 as this but was called with %t"),g("alwaysCalledOn","expected %n to always be called with %1 as this but was called with %t"),g("calledWithNew","expected %n to be called with new"),g("alwaysCalledWithNew","expected %n to always be called with new"),g("calledWith","expected %n to be called with arguments %*%C"),g("calledWithMatch","expected %n to be called with match %*%C"),g("alwaysCalledWith","expected %n to always be called with arguments %*%C"),g("alwaysCalledWithMatch","expected %n to always be called with match %*%C"),g("calledWithExactly","expected %n to be called with exact arguments %*%C"),g("alwaysCalledWithExactly","expected %n to always be called with exact arguments %*%C"),g("neverCalledWith","expected %n to never be called with arguments %*%C"),g("neverCalledWithMatch","expected %n to never be called with match %*%C"),g("threw","%n did not throw exception%C"),g("alwaysThrew","%n did not always throw exception%C"),a.assert=d,d}function g(a,b,c){var e=a("./util/core");a("./match"),a("./format"),c.exports=d(e)}var c=Array.prototype.slice,e="undefined"!=typeof module&&module.exports&&"function"==typeof require,f="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(f)define(g);else if(e)g(require,module.exports,module);else{if(!a)return;d(a)}}("object"==typeof sinon&&sinon||null,"undefined"!=typeof window?window:"undefined"!=typeof self?self:global),sinon});